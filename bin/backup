#!/bin/zsh
set -xv

root="${1:-$HOME}"
name="${${root#/}//\//_}"

[[ $# -eq 0 ]] || shift

exec borg create \
  -C lz4 \
  -v \
  -s \
  -p \
  --exclude-from ~/.config/borg/exclude \
  --exclude-caches \
  --keep-tag-files \
  $BORG_REPO::"{hostname}-{user}-${name}-{now}" \
  "$@" "$root"

